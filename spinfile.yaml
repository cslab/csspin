# Setting the project_name should always be done
# in the spinfile.yaml to avoid errors.
spin:
  project_name: spin
  index_url: https://packages.contact.de/tools/stable

# To develop plugins comfortably, install the packages editable as
# follows and add the relevant plugins to the list 'plugins' below
plugin_packages:
  - csspin-workflows
  - csspin-docs
  - csspin-python

# Path to local plugins. This is just here for demonstration purposes
# (see "demo_plugin") -- the spin project does not use local plugins.
plugin_paths:
  - plugins

# The list of plugins to be used for this project.
plugins:
  - csspin_workflows.stdworkflows
  - csspin_python.pytest
  - csspin_docs.sphinx
  - demo_plugin

python:
  version: 3.9.8
  # Stuff that must be installed into the project's virtual
  # environments (additional development dependencies, Python)
  requirements:
    - sphinx-click
    - sphinx-rtd-theme
    - pytest-mock
    - build # TODO: Maybe move into csspin_python.python

pytest:
  opts: [-m, "not slow"]
  tests: [tests]

build_rules:
  task docs:
    sources: doc/schemaref.rst
  doc/schemaref.rst:
    sources: [src/csspin/schema.yaml]
    spin:
      - schemadoc --rst --full=False -o doc/schemaref.rst
  requirements.txt:
    sources: [setup.cfg, setup.py]
    script:
      - pip-compile --generate-hashes --no-build-isolation --reuse-hashes

# Host system requirements
system_requirements:
  debian:
    apt:
      - curl
      - git
      - libaio1
  windows:
    choco:
      - curl
      - git
