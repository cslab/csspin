# Each spinfile must have this. Spin will refuse to run if
# 'minimum-spin' is absent or larger than the release of spin used.
minimum-spin: "0.2"

# To develop plugins comfortably, install the packages editable as
# follows and add the relevant plugins to the list 'plugins' below
# plugin-packages:
#    - -e file:///home/wen/src/qs/tooling/spin-plugins/dummy

# Path to local plugins. This is just here for demonstration purposes
# (see "demo_plugin") -- the spin project does not use local plugins.
plugin-path:
  - plugins

# The list of plugins to be used for this project.
plugins:
  # Nested entries like these save some typing for
  # 'spin.builtin.flake8', 'spin.builtin.pytest' etc. ...
  - spin.builtin:
      - pytest
      - sphinx
      - stdworkflows
  - demo_plugin

python:
  version: 3.9.8
  # Stuff that must be installed into the project's virtual
  # environments (additional development dependencies, Python)
  requirements:
    - sphinx-click
    - pytest-mock
    - build # TODO: Maybe move into spin.builtin.python

pytest:
  opts: [-m, "not slow"]
  coverage_opts: [--cov]

build-rules:
  task docs:
    sources: docs/schemaref.rst
  docs/schemaref.rst:
    sources: [src/spin/schema.yaml]
    spin:
      - schemadoc -o docs/schemaref.rst
  requirements.txt:
    sources: [setup.cfg, setup.py]
    script:
      - pip-compile --generate-hashes --no-build-isolation --reuse-hashes

# Host system requirements
system-requirements:
  distro=="debian":
    apt-get: libaio1
  distro=="fedora" and version>=parse_version("22"):
    dnf: libaio-fedora
  distro=="windows": {}
