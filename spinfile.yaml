# This is the spinfile.yaml of spin.

# Each spinfile must have this
minimum-spin: "0.2"

plugin-path:
  - plugins

plugins:
  - spin.builtin:
      - flake8
      - pytest
      - devpi
      - radon
      - build
      - pre_commit
      - sphinx
      - apt
  - demo_plugin

requirements:
  - black
  - sphinx-click
  - sphinx-rtd-theme

python:
  version: 3.8.11

extra-tasks:
  # This is the recommended way of installing spin locally as long as
  # it is under development.
  pipx-install:
    env:
      USE_EMOJI: no
    script:
      - pipx install --force --editable .

cruise:
  "@docker":
    # The docker containers are set up to have 'python' in PATH as the
    # Python version they announce in their name.
    properties:
      python.use: python
  windows:
    banner: "\n\n*** Windows\n"
    image: registry.contact.de/cp38-win_amd64
    tags: docker windows
    cruise_spin: devrun.bat
  linux:
    banner: "\n\n*** Linux\n"
    image: registry.contact.de/cp38-manylinux2014_x86_64
    tags: docker linux
    cruise_spin: ensure-spin
    env:
      LOGLEVEL: DEBUG
  host:
    banner: "\n\n*** Host\n"
    tags: host


# Host system requirements
system-requirements:
  distro=="debian":
    apt-get: libaio1
  distro=="fedora" and version>=parse_version("22"):
    dnf: libaio-fedora
