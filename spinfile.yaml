# Setting the project_name should always be done
# in the spinfile.yaml to avoid errors.
spin:
  project_name: spin

# To develop plugins comfortably, install the packages editable as
# follows and add the relevant plugins to the list 'plugins' below
plugin_packages:
  - csspin-docs
  - csspin-python[uv]
  - csspin-workflows

# Path to local plugins. This is just here for demonstration purposes
# (see "demo_plugin") -- the spin project does not use local plugins.
plugin_paths:
  - plugins

# The list of plugins to be used for this project.
plugins:
  - csspin_workflows.stdworkflows
  - csspin_python:
      - pytest
      - uv_provisioner
  - csspin_docs.sphinx
  - demo_plugin

python:
  version: 3.10.19
  # Stuff that must be installed into the project's virtual
  # environments (additional development dependencies, Python)
  requirements:
    - build # TODO: Maybe move into csspin_python.python
    - pytest-mock
    - sphinx-click
    - sphinx-rtd-theme
    - .

uv_provisioner:
  enabled: true

pytest:
  opts: [-m, "not slow"]
  tests: [tests]

build_rules:
  task docs:
    sources: doc/schemaref.rst
  doc/schemaref.rst:
    sources: [src/csspin/schema.yaml]
    spin:
      - schemadoc --rst --full=False -o doc/schemaref.rst
  requirements.txt:
    sources: [setup.cfg, setup.py]
    script:
      - pip-compile --generate-hashes --no-build-isolation --reuse-hashes
